<h2>What to Read Next</h2>
<div id="what-to-read-next" class="row"></div>

<script type="text/template" id="what-to-read-next-template">
    <% _.each(models, function(model, key, list){ %>
        <div class="col-xs-3">
            <!-- <img src="<%= model.attributes.hero_image %> class="img-responsive center-block"> -->
            <div style="background-image:url('<%= model.attributes.hero_image %>');" class="article-header-img-thumbnail"></div>
            <a href="/#/<%= model.attributes.slug %>" role="button"><%= model.attributes.title %>... &raquo;</a>
        </div>
    <% }); %>
</script>

<script type="text/javascript">
function fetch_recommended_articles() {
    compiled_template = _.template($('#what-to-read-next-template').html())
    function getUserReadingData(){
        if (article){
            return {
                current_article: article.attributes.slug,
                category: article.attributes.category_slug
            }
        }else{
            return {}
        }
    }

    var recommendedArticles = new ArticleList()
    recommendedArticles.url = '/articles/recommend/'
    recommendedArticles.fetch({
        data: getUserReadingData(),
        processData: true,
        success: function(collection, response, options) {
            template = compiled_template(collection)
            $('#what-to-read-next').html(template)
        }
    });

}

window.onload = fetch_recommended_articles
</script>
